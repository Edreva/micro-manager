<project name="MMClearVolume" basedir="." default="jar">
	<import file="../javapluginbuild.xml"/>

   <!-- lots of hoopla to install the native jogamp/gluegen libraries
         Please replace with something simplere and more elegant if 
         you can think of it-->
   <condition property="mm.architecture.is_Win32">
      <equals arg1="${mm.architecture}" arg2="Win32"/>
   </condition>

   <condition property="mm.architecture.is_x64">
      <equals arg1="${mm.architecture}" arg2="x64"/>
   </condition>

   <target name="install-if-Win32" if="mm.architecture.is_Win32">
      <antcall target="install-Win32"/>
   </target>

   <target name="install-if-x64" if="mm.architecture.is_x64">
      <antcall target="install-x64"/>
   </target>

   <target name="install-only" depends="install-if-Win32,install-if-x64">
      <!-- no idea why the top level install-only is no longer executed
           copy the code here and pray-->
      <fail unless="installdir"/>
      <mkdir dir="${installdir}"/>
      <copy todir="${installdir}" file="${jarfile}"/>
   </target>

   <target name="install-Win32">
      <zipfileset src="${mm.basedir}/dependencies/artifacts/compile/gluegen-rt-2.3.2-natives-windows-i586.jar"
                  includes="natives/windows-i586/gluegen-rt.dll" fullpath="${mm.dll.installdir}/gluegen-rt.dll"/>
      <zipfileset src="${mm.basedir}/dependencies/artifacts/compile/jogl-all-2.3.2-natives-windows-i586.jar"
                  includes="natives/windows-i586/*.dll" fullpath="${mm.dll.installdir}"/>
   </target>


   <target name="install-x64">
      <zipfileset src="${mm.basedir}/dependencies/artifacts/compile/gluegen-rt-2.3.2-natives-windows-amd64.jar"
                  includes="natives/windows-amd64/gluegen-rt.dll" fullpath="${mm.dll.installdir}/gluegen-rt.dll"/>
      <zipfileset src="${mm.basedir}/dependencies/artifacts/compile/jogl-all-2.3.2-natives-windows-amd64.jar"
                  includes="natives/windows-amd64/*.dll" fullpath="${mm.dll.installdir}"/>
   </target>
</project>